---
title: "2-Entrega2"
author: "Lisandro Carrasco"
date: "2023-05-10"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
path <- here::here()

path_output <- glue::glue(path, "/Output")
# Aca deberia ir la parte de renv

library(dplyr)
library(stringr)
library(tidyr)
library(tibble)
library(lubridate)
library(ggplot2)
library(plotly)
library(tsibble)
library(forecast)
library(feasts)
library(prophet)
library(descr)
library(shiny)

options(
  encoding = 'UTF-8',
  scipen = 9999
  )

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
data <- read.csv(glue::glue('{path}/Output/data_entera.csv'))
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

shinyApp(
  ui = fluidPage(
    selectInput(
      'ticker', 'Seleccione una acciÃ³n:',
      choices = c("MSFT", "NVDA", "AAPL", "TSLA", "XOM", "V", "GOOG", "AMZN", "BRK-A", "META")
    ),
    plotOutput('plot')
  ),
  
  server = function(input, output) {
    serie_tiempo <- reactive({
      data %>%
        filter(Ticker == input$ticker) %>% 
        select(ds = Date, y = Close) %>% 
        mutate(ds = as.Date(ds)) %>% 
        filter(ds > '2020-10-01' & ds < '2023-12-01') %>% 
        group_by(ds = floor_date(ds, unit = "week")) %>% 
        summarise(y = mean(y, na.rm = TRUE)) %>% 
        as_tsibble(index = ds)
    })
    
    output$plot <- renderPlot({
      plot(decompose(ts(serie_tiempo()$y, frequency = 52)))
    })
  }
)

```

